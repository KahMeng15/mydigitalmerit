<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Matric + Name Parsing Tests</title>
  <style>
    body { font-family: system-ui, -apple-system, Arial; padding: 1rem; }
    .ok { color: green }
    .bad { color: red }
    pre { background:#f5f5f5; padding:8px }
  </style>
</head>
<body>
  <h1>Matric & Name Parsing Tests</h1>
  <div id="results">Running tests...</div>

  <script src="../utils.js"></script>
  <script>
    function run() {
      const cases = [
        {email: 's12345@student.upm.edu.my', expectMatric: 'S12345', name: 'FIRST NAME LAST / UPM', expectName: 'First Name Last'},
        {email: 'a12345678@uni.example.edu', expectMatric: 'A12345678', name: 'DOE JOHN - UPM', expectName: 'Doe John'},
        {email: 'john.doe+alias@college.edu', expectMatric: 'JOHNDOE', name: 'john doe', expectName: 'John Doe'},
        {email: 'user@gmail.com', expectMatric: '', name: 'User', expectName: 'User'}
      ];

      const out = [];

      cases.forEach(c => {
        const extracted = (typeof extractMatricFromEmail === 'function') ? extractMatricFromEmail(c.email) : '';
        const normalized = (typeof normalizeMatric === 'function') ? normalizeMatric(extracted) : extracted;
        const nameClean = (typeof cleanDisplayName === 'function') ? cleanDisplayName(c.name) : c.name;
        const flexOk = (typeof isFlexibleMatric === 'function') ? isFlexibleMatric(normalized) : Boolean(normalized);

        out.push({
          email: c.email,
          extracted,
          normalized,
          flexOk,
          nameClean
        });
      });

      const resultsEl = document.getElementById('results');
      resultsEl.innerHTML = '';
      out.forEach(r => {
        const okMatric = r.normalized === (r.email.includes('gmail.com') ? '' : r.normalized);
        const div = document.createElement('div');
        div.innerHTML = `<strong>${r.email}</strong> â€” extracted: <code>${r.extracted}</code>, normalized: <code>${r.normalized}</code>, flexible-ok: ${r.flexOk}, name-clean: <code>${r.nameClean}</code>`;
        resultsEl.appendChild(div);
      });
    }

    run();
  </script>
</body>
</html>
